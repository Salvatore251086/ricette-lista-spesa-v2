name: Auto crawl & checks

on:
  workflow_dispatch: {}
  schedule:
    - cron: "0 3 * * *"  # ogni giorno alle 03:00 UTC

jobs:
  crawl-and-check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm

      - name: Install dipendenze
        run: npm ci

      # QUI solo script interni "safe"
      - name: Controllo URL
        run: npm run check:urls

      - name: Aggiorna indice video
        run: npm run update:videos

      - name: Genera quality report
        run: npm run report

      - name: Mostra cambi
        run: git diff || true

      # Non facciamo commit automatici per ora
